# Тесты роутинга

[← Назад](../README.md)

Тесты маршрутов и гардов приложения.

## Что проверяем

- Гард `requiresAuth` на защищенных маршрутах.
- Гард `guestOnly` на публичных маршрутах.
- Параметр `redirect` при отправке гостя на login.
- Имена маршрутов `ROUTE_NAME_HOME`, `ROUTE_NAME_LOGIN`, `ROUTE_NAME_NOT_FOUND` (импортируйте из `src/router/constants.ts`).
- Обработку неизвестных маршрутов через 404-страницу.

## Подход

- Перед каждым тестом очищайте `localStorage`.
- Для стабильности навигации используйте `router.replace(...)` и `router.isReady()`.
- Для проверки сессии достаточно установить `session-id` в `localStorage`.

Пример базовой навигации:

```ts
const navigateTo = async (path: string) => {
  await router.push(path)
  await router.isReady()
}
```

## Список тестов

### `tests/router/guards.spec.ts`

| Тест | Описание |
| --- | --- |
| `редиректит гостя на логин при переходе на защищенную страницу` | Проверяет редирект на страницу входа при отсутствии сессии. |
| `разрешает доступ к защищенной странице при наличии сессии` | Проверяет доступ на главную при наличии SID. |
| `редиректит авторизованного пользователя с логина на главную` | Проверяет редирект с login для авторизованного пользователя. |
| `разрешает гостю оставаться на странице логина` | Проверяет, что гость остается на login без редиректа. |
| `открывает страницу 404 для неизвестного маршрута` | Проверяет, что неизвестный путь ведет на страницу 404. |
